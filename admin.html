<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="site-header" style="background:#222a44;">
    <div class="topbar">
      <h1 style="color:#ffeb3b;">ADMIN DASHBOARD</h1>
    </div>
    <button id="menuToggle" class="menu-toggle">â˜°</button>
    <nav style="background:#1a2036;">
      <a href="admin.html">Dashboard</a>
      <a href="admin_cases.html">Cases</a>
      <a href="admin_members.html">Members</a>
      <a href="admin_sms.html">Group Messages</a>
      <a href="admin_add_admin.html">Add Admin</a>
      <a href="#" id="logoutBtn">Logout</a>
    </nav>
  </header>
  <main>
    <section style="margin-bottom:32px;">
      <h2 style="color:#222a44;">Welcome, Admin!</h2>
      <p style="font-size:1.1em;">This is your private management area. Use the links above to manage cases, members, and group messages. All actions here are admin-only.</p>
    </section>
    <section class="cards">
      <div class="card">
        <h2>Total Members</h2>
        <p id="adminTotalMembers">-</p>
        <a href="admin_members.html" class="btn">Manage Members</a>
      </div>
      <div class="card">
        <h2>Total Cases</h2>
        <p id="adminTotalCases">-</p>
        <a href="admin_cases.html" class="btn">Manage Cases</a>
      </div>
      <div class="card">
        <h2>Total Contributions</h2>
        <p id="adminTotalContributions">-</p>
        <a href="admin_cases.html" class="btn">View Contributions</a>
      </div>
      <div class="card">
        <h2>Group Messages</h2>
        <a href="admin_sms.html" class="btn">Send/View Messages</a>
      </div>
    </section>
  </main>
  <script src="js/auth.js"></script>
  <script>
  // Admin-only access check
  const currentUser = JSON.parse(localStorage.getItem("currentMember"));
  if (!currentUser || currentUser.role !== "admin") {
    alert("Access denied. Admins only.");
    window.location.href = "login.html";
  }
  // Dashboard stats
  document.addEventListener("DOMContentLoaded", () => {
    const members = JSON.parse(localStorage.getItem("members")) || [];
    const cases = JSON.parse(localStorage.getItem("cases")) || [];
    let totalContributions = 0;
    cases.forEach(c => {
      c.contributions && c.contributions.forEach(contrib => {
        if (contrib.paid) totalContributions += (contrib.contribution || 0) + (contrib.gap || 0);
      });
    });
    document.getElementById("adminTotalMembers").textContent = members.length;
    document.getElementById("adminTotalCases").textContent = cases.length;
    document.getElementById("adminTotalContributions").textContent = totalContributions + " Ksh";
  });
  // Logout
  document.getElementById("logoutBtn").onclick = function() {
    localStorage.removeItem("currentMember");
    window.location.href = "login.html";
  };
  // Create case form handler (delegated to cases.js for logic)
  // SMS form handler (delegated to sms.js for logic)
  </script>
</body>
</html>